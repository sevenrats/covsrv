{#- Reusable navbar macro.

    Import:  {% from '_navbar.html' import navbar %}
    Call:    {{ navbar(github_url=github_url) }}

    extra_buttons_html: raw HTML for page-specific buttons rendered
    before the repository link.
-#}

{% macro navbar(github_url='', extra_buttons_html='') %}
<style>
  .navbar {
    display: flex;
    align-items: center;
    padding: 8px 16px;
    gap: 10px;
    background: #fafafa;
    border-bottom: 1px solid #e2e2e2;
  }

  .nav-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: 1px solid #e2e2e2;
    background: white;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    color: #333;
    transition: all 0.15s ease;
    cursor: pointer;
  }

  .nav-btn:hover {
    background: #f0f0f0;
    border-color: #d0d0d0;
  }

  .nav-btn svg {
    width: 18px;
    height: 18px;
  }

  .nav-spacer { flex: 1; }

  .menu-wrap {
    position: relative;
  }

  .context-menu {
    display: none;
    position: absolute;
    right: 0;
    top: 40px;
    background: white;
    border: 1px solid #e2e2e2;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    min-width: 180px;
    z-index: 100;
    padding: 4px 0;
  }

  .context-menu.open { display: block; }

  .context-menu a {
    display: block;
    padding: 8px 14px;
    font-size: 13px;
    color: #333;
    text-decoration: none;
    white-space: nowrap;
  }

  .context-menu a:hover {
    background: #f5f5f5;
  }

  .context-menu .sep {
    border-top: 1px solid #e8e8e8;
    margin: 4px 0;
  }
</style>

<nav class="navbar">
  {{ extra_buttons_html|safe }}
  <a class="nav-btn" href="{{ github_url }}" title="Repository">
    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.009-.866-.013-1.7-2.782.604-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.464-1.11-1.464-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.831.092-.646.35-1.086.636-1.336-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.167 22 16.418 22 12c0-5.523-4.477-10-10-10z"/></svg>
  </a>
  <span class="nav-spacer"></span>
  <div class="menu-wrap">
    <button class="nav-btn" id="menuBtn" title="Menu" type="button">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
    </button>
    <div class="context-menu" id="contextMenu">
    </div>
  </div>
</nav>

<script>
  (function() {
    var btn = document.getElementById("menuBtn");
    var menu = document.getElementById("contextMenu");
    if (!btn || !menu) return;
    btn.addEventListener("click", function(e) {
      e.stopPropagation();
      menu.classList.toggle("open");
    });
    document.addEventListener("click", function() {
      menu.classList.remove("open");
    });
  })();
</script>
{% endmacro %}
